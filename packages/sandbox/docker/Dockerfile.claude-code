# Claude Code agent sandbox
FROM orkee/sandbox:base

# Install Claude Code CLI dependencies
RUN apt-get update && apt-get install -y \
    # Additional tools Claude Code might need
    ripgrep \
    fd-find \
    bat \
    fzf \
    # Version control
    git-lfs \
    gh \
    # Container tools
    docker.io \
    docker-compose \
    && apt-get clean \
    && rm -rf /var/lib/apt/lists/*

# Install language-specific tools
RUN pip3 install --no-cache-dir \
    ipython \
    jupyter \
    pandas \
    numpy \
    matplotlib \
    scikit-learn

# Install additional Node.js tools
RUN npm install -g \
    @vue/cli \
    @angular/cli \
    create-react-app \
    next \
    vite \
    pnpm \
    yarn \
    bun

# Install Go
RUN curl -L https://go.dev/dl/go1.21.5.linux-amd64.tar.gz | tar -xz -C /usr/local \
    && ln -s /usr/local/go/bin/go /usr/local/bin/go \
    && ln -s /usr/local/go/bin/gofmt /usr/local/bin/gofmt

# Install Deno
RUN curl -fsSL https://deno.land/install.sh | sh \
    && echo 'export DENO_INSTALL="/root/.deno"' >> /root/.bashrc \
    && echo 'export PATH="$DENO_INSTALL/bin:$PATH"' >> /root/.bashrc

# Set up Claude Code agent server
WORKDIR /agent

# Copy agent server code (to be implemented)
# COPY ./claude-code-server /agent/

# Environment variables for Claude Code
ENV CLAUDE_CODE_WORKSPACE=/workspace
ENV CLAUDE_CODE_PORT=8080
ENV CLAUDE_CODE_HOST=0.0.0.0

# Expose agent communication port
EXPOSE 8080

# Start the agent server
# CMD ["python3", "/agent/server.py"]
CMD ["/bin/bash", "-c", "echo 'Claude Code sandbox ready' && tail -f /dev/null"]